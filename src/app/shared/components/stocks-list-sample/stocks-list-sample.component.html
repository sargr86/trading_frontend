<div class="crypto-content" *ngIf="!portable">
    <div class="crypto-item" *ngFor="let stock of passedStocks"
         [class.crypto-item-green]="stock.changesPercentage > 0">
        <div class="stock-follow" [hidden]="!follow">
            <button (click)="updateFollowedStocksList(stock)" *ngIf="!isStockFollowed(stock)">Follow</button>

            <button class="unfollow-btn" (click)="updateFollowedStocksList(stock)" *ngIf="isStockFollowed(stock)">
                <mat-icon>delete</mat-icon>
            </button>
        </div>
        <div (click)="openStockProfile(stock.symbol)">
            <p class="crypto-text-1">{{stock.name}}</p>
            <p class="crypto-text-2"><span class="crypto-text-abs">$</span>{{stock.price}}</p>
            <div class="crypto-block">
                <p class="crypto-text-1">{{stock.change?.toFixed(2)}}</p>
                <p class="crypto-text-1">{{stock.changesPercentage}}%</p>
            </div>
        </div>
        <!--                    <div class="small-chart-container">-->
        <!--                        <ngx-charts-line-chart  [scheme]="colorScheme" [legend]="false"-->
        <!--                                               [showXAxisLabel]="false"-->
        <!--                                               [showYAxisLabel]="false" [xAxis]="true" [yAxis]="true"-->
        <!--                                               [results]="multi"-->
        <!--                                               [autoScale]="true"-->
        <!--                                               [yAxisTicks]="[]" [xAxisTicks]="[]" [timeline]="true"-->
        <!--                                               [referenceLines]="referenceLines" [showRefLines]="true"-->
        <!--                                               [showGridLines]="true" [showRefLabels]="false">-->
        <!--                        </ngx-charts-line-chart>-->
        <!--                    </div>-->
        <!--                <img class="crypto-map" src="assets/img/map.png">-->
    </div>
    <mat-error *ngIf="stocksLoading=='finished' && passedStocks?.length ===0">No results found</mat-error>
</div>
<div id="portable-stocks-list" *ngIf="portable">
    <div class="stocks-top-actions">

        <div class="search-stocks">
            <ng-container>
                <div class="watchlist-search" *ngIf="editUserStocks">
                    <input class="watchlist-input" placeholder="Search">
                    <i class="fas fa-search"></i>
                </div>
                <div class="dropdown" *ngIf="sort">
                    <div class="dropdown-toggle" id="dropdownMenuButton" data-toggle="dropdown"
                         aria-haspopup="true"
                         aria-expanded="false">
                        Sort by {{selectedSortType}}
                    </div>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                        <a class="dropdown-item">My sort</a>
                        <a class="dropdown-item" [class.red]="selectedSortType === 'A-Z'" (click)="sortStocks('A-Z')">A-Z</a>
                        <a class="dropdown-item" [class.red]="selectedSortType === 'Gain'" (click)="sortStocks('Gain')">Gain</a>
                        <a class="dropdown-item" [class.red]="selectedSortType === 'Loss'" (click)="sortStocks('Loss')">Loss</a>
                    </div>
                </div>
            </ng-container>
        </div>
        <div class="context-actions" *ngIf="editPortable">
            <mat-icon [matMenuTriggerFor]="menu" *ngIf="!editUserStocks">more_horiz</mat-icon>
            <mat-icon *ngIf="editUserStocks" (click)="editUserStocks = !editUserStocks">done</mat-icon>
            <mat-menu #menu="matMenu">
                <button mat-menu-item (click)="editUserStocks = !editUserStocks">
                    Edit Watchlist
                </button>
            </mat-menu>
        </div>


    </div>
    <div id="portable-stocks" cdkDropList (cdkDropListDropped)="drop($event)" *ngIf="passedStocks?.length > 0">
        <ng-container *ngFor="let stock of onlyFirst10Stocks(passedStocks); let ind = index">
            <div class="analytics-item" cdkDrag
                 (cdkDragDropped)="dragDropped($event, stock)">
                <div class="analytics-delete" *ngIf="editUserStocks" (click)="updateFollowedStocksList(stock)">
                    <i class="fas fa-trash"></i>
                </div>
                <div class="analytics-texts" (click)="openStockProfile(stock.symbol)">
                    <div class="analytics-item-1">
                        <p class="analytics-text-1">{{stock.symbol.replace('^', '')}}</p>
                        <p class="analytics-text-2">{{stock.name}}</p>
                    </div>

                    <ng-container
                        [ngTemplateOutlet]="itemTemplate"
                        [ngTemplateOutletContext]="{details: getPercentageDetails(stock)}">
                    </ng-container>

                    <ng-template let-d="details" #itemTemplate>
                        <div class="analytics-img">
                            <ng-container *ngIf="d?.color === 'green'">
                                <img src="assets/img/green-up.png">
                                <img src="assets/img/green-point.png">
                            </ng-container>
                            <img src="assets/img/red-down.png" *ngIf="d?.color === 'red'">
                            <img src="assets/img/red-point.png" *ngIf="d?.color === 'red'">
                        </div>
                        <div class="analytics-percent">
                            <p class="analytics-text-3">{{stock.price}}</p>
                            <p [ngClass]="d?.class">
                                {{stock.change?.toFixed(2)}}({{d?.value?.toFixed(2)}}%)</p>
                        </div>
                    </ng-template>
                </div>
            </div>

        </ng-container>
    </div>
</div>
